#!/bin/bash

# Скрипт для запуска определенного теста Playwright несколько раз.
# Используется для выявления "flaky" (нестабильных) тестов.

# Проверяем, что передано два аргумента
if [ "$#" -ne 2 ]; then
    echo "Использование: $0 \\"<шаблон_имени_теста>\\" <количество_повторений>"
    echo "Пример: $0 \\"TC-HP-005\\" 20"
    exit 1
fi

TEST_PATTERN=$1
REPEAT_COUNT=$2

echo "Запуск тестов, соответствующих шаблону: '$TEST_PATTERN'"
echo "Количество повторений для каждого теста: $REPEAT_COUNT"
echo "----------------------------------------------------"

# Запускаем тесты
npx playwright test tests --grep "$TEST_PATTERN" --repeat-each "$REPEAT_COUNT" 